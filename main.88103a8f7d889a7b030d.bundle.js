webpackJsonp([0,4],{202:function(t,e,n){"use strict";var i=n(70),a=n(96);n.d(e,"a",function(){return o});var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=function(){function t(){}return t.all=[],t}(),s=function(t){function e(){t.call(this,"m","Move the organism by one element in the current orientation of the head")}return r(e,t),e.prototype.do=function(t,e,n){t.move(e,!1)},e}(a.a);o.all.push(new s);var l=function(t){function e(){t.call(this,"M","Move and eat any food or Photosyntheize cell in front of the head")}return r(e,t),e.prototype.do=function(t,e,n){t.move(e,!0)},e}(a.a);o.all.push(new l);var c=function(t){function e(){t.call(this,"H","Hypermode!")}return r(e,t),e.prototype.do=function(t,e,n){return t.instructionsPerTurn+=t.instructionsPerTurn,a.b.EXECUTE_AGAIN},e}(a.a);o.all.push(new c);var u=function(t){function e(){t.call(this,"*","Gains energy")}return r(e,t),e.prototype.do=function(t,e,n){},e}(a.a);o.all.push(new u);var h=function(t){function e(){t.call(this,"Z","Sleep")}return r(e,t),e.prototype.do=function(t,e,n){t.sleepCount+=5},e}(a.a);o.all.push(new h);var p=function(t){function e(){t.call(this,"<","Turn left")}return r(e,t),e.prototype.do=function(t,e,n){t.setOrientation((t.headOrientation+3)%4)},e}(a.a);o.all.push(new p);var d=function(t){function e(){t.call(this,">","Turn right")}return r(e,t),e.prototype.do=function(t,e,n){t.setOrientation((t.headOrientation+1)%4)},e}(a.a);o.all.push(new d);var f=function(t){function e(){t.call(this,"U","Orient Up")}return r(e,t),e.prototype.do=function(t,e,n){t.setOrientation(0)},e}(a.a);o.all.push(new f);var m=function(t){function e(){t.call(this,"D","Orient Down")}return r(e,t),e.prototype.do=function(t,e,n){t.setOrientation(2)},e}(a.a);o.all.push(new m);var v=function(t){function e(){t.call(this,"L","Orient Left")}return r(e,t),e.prototype.do=function(t,e,n){t.setOrientation(3)},e}(a.a);o.all.push(new v);var g=function(t){function e(){t.call(this,"R","Orient Right")}return r(e,t),e.prototype.do=function(t,e,n){t.setOrientation(1)},e}(a.a);o.all.push(new g);var y=function(t){function e(){t.call(this,"0","Test if facing food")}return r(e,t),e.prototype.do=function(t,e,n){if(!t.testIfFacing(i.a.FOOD,e))return t.doNotIf(),a.b.DONT_ADVANCE},e}(a.a);o.all.push(new y);var b=function(t){function e(){t.call(this,"1","Test if NOT facing food")}return r(e,t),e.prototype.do=function(t,e,n){if(t.testIfFacing(i.a.FOOD,e))return t.doNotIf(),a.b.DONT_ADVANCE},e}(a.a);o.all.push(new b);var w=function(t){function e(){t.call(this,"2","Test if blocked")}return r(e,t),e.prototype.do=function(t,e,n){if(!t.wasBlocked)return t.doNotIf(),a.b.DONT_ADVANCE},e}(a.a);o.all.push(new w);var O=function(t){function e(){t.call(this,"3","Test if NOT blocked")}return r(e,t),e.prototype.do=function(t,e,n){if(t.wasBlocked)return t.doNotIf(),a.b.DONT_ADVANCE},e}(a.a);o.all.push(new O);var S=function(t){function e(){t.call(this,"e","Else")}return r(e,t),e.prototype.do=function(t,e,n){t.energy+=.75*e.parameters.energyTurnCost},e}(a.a);o.all.push(new S)},203:function(t,e,n){"use strict";var i=n(302),a=n(70),r=n(97);n.d(e,"a",function(){return o});var o=function(){function t(t,e){void 0===e&&(e=!1),this.preparePixels(t),e&&this.determineTopTenList(t)}return t.prototype.preparePixels=function(e){var n=r.a.WORLDSIZE,o=n*n*4;null!=t._pixels&&t._pixels.byteLength==o||(t._pixels=new ArrayBuffer(o)),this.pixels=t._pixels;for(var s=new Uint32Array(this.pixels),l=new i.a(0,0,0).rgba,c=new i.a(128,128,128).rgba,u=new i.a(0,255,0).rgba,h=new i.a(0,128,0).rgba,p=0,d=0;d<n;d++)for(var f=0;f<n;f++){var m=e.elements[d][f];if(m)switch(m.type){case a.a.BARRIER:s[p++]=c;break;case a.a.FOOD:s[p++]=m.organism?u:h;break;case a.a.ORGANISM:s[p++]=m.organism.colorRGBA}else s[p++]=l}},t.prototype.determineTopTenList=function(t){for(var e={},n=t.headOrganism;n;){var a=n.genome;e.hasOwnProperty(a)?++e[a].count:e[a]={genome:a,count:1,color:new i.a(n.colorRGBA).getAsCSS()},n=n.next}var r=[];for(var o in e)r.push(e[o]);for(r.sort(function(t,e){return e.count-t.count}),this.topTenList=r.slice(0,10);this.topTenList.length<10;)this.topTenList.push({genome:" - ",count:" ",color:"white"})},t.prototype.getTransferableData=function(){var t=[];return t.push(this.pixels),t},t}()},302:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(){function t(e,n,i,a){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===a&&(a=255),this._r=0,this._g=0,this._b=0,this._a=0,this._rgba=0,null===n?(t.isLittleEndian?(this._b=e>>16&255,this._g=e>>8&255,this._r=255&e,this._a=255):(this._a=e>>16&255,this._r=e>>8&255,this._g=255&e,this._b=255),void(this._rgba=e)):(this._r=e,this._g=n,this._b=i,this._a=a,void(t.isLittleEndian?this._rgba=this._a<<24|this._b<<16|this._g<<8|this._r:this._rgba=this._r<<24|this._g<<16|this._b<<8|this._a))}return Object.defineProperty(t.prototype,"r",{get:function(){return this._r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"g",{get:function(){return this._g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"b",{get:function(){return this._b},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rgba",{get:function(){return this._rgba},enumerable:!0,configurable:!0}),t.prototype.getAsCSS=function(){return"rgba("+this._r+","+this._g+","+this._b+","+this._a+")"},t.isLittleEndian=function(){var t=new ArrayBuffer(4),e=new Uint32Array(t),n=new Uint8Array(t);e[0]=168496141;return 10!==n[0]||11!==n[1]||12!==n[2]||13!==n[3]}(),t}()},303:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.randomize=function(t){this.x=Math.floor(t*Math.random()),this.y=Math.floor(t*Math.random())},t}()},304:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(){function t(){}return t.randRangeInt=function(t,e){return Math.floor(t+(e-t+1)*Math.random())},t}()},305:function(t,e,n){"use strict";var i=n(477),a=n(97),r=n(203);n.d(e,"a",function(){return o});var o=function(){function t(t){void 0===t&&(t=null),t||(t=new a.a),this.params=t,this.world=new i.a(t)}return t.prototype.run=function(e){function n(){o.world.turnCrank();var n=(new Date).getTime(),s=n-i,l=n-a,c=l>t.MIN_SURVEY_MS;if(s>t.MIN_RENDER_MS){i=n,c&&(a=n);var u=new r.a(o.world,c);e(u)}}var i=0,a=0,o=this;window.setInterval(n,0)},t.workerThreadFunction=function(){var e=new i.a(new a.a),n=this;n.postMessage("starting up");new t;n.addEventListener("message",function(t){n.postMessage("got message: "+t.data),e.turnCrank()})},t.prototype.setObstacles=function(t){this.world.setObstacles(t)},t.prototype.reset=function(){this.world.reset()},t.prototype.insert=function(t){this.world.insert(t)},t.MIN_RENDER_MS=16,t.MIN_SURVEY_MS=100,t}()},356:function(t,e){function n(t){throw new Error("Cannot find module '"+t+"'.")}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=356},357:function(t,e,n){"use strict";var i=n(473),a=(n.n(i),n(447)),r=n(0),o=n(472),s=n(468);o.a.production&&n.i(r.enableProdMode)(),n.i(a.a)().bootstrapModule(s.a)},467:function(t,e,n){"use strict";var i=n(0),a=n(306),r=(n.n(a),n(469)),o=n(475);n.d(e,"a",function(){return c});var s=this&&this.__decorate||function(t,e,n,i){var a,r=arguments.length,o=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,n,o):a(e,n))||o);return r>3&&o&&Object.defineProperty(e,n,o),o},l=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},c=function(){function t(t,e){this.elementRef=t,this._webWorkerService=e,this.modalActions=new i.EventEmitter,this.obstacles=0,this.allInstructions=[];var n=!1;if(this.params=new o.a,this.worldRunner=new o.b(this.params),this.allInstructions=o.c.all,n){var a=this._webWorkerService.run(function(){});this.worker=this._webWorkerService.getWorker(a),this.worker.onmessage=function(t){console.log("Message received from worker: "+t.data)};var r=0,s=this;setInterval(function(){s.worker.postMessage(["hey there, worker #"+ ++r])},1e3)}else{var s=this;this.worldRunner.run(function(t){s.renderPixels=t.getTransferableData(),t.topTenList&&(s.topTen=t.topTenList)})}}return t.prototype.ngOnInit=function(){var t=$(this.elementRef.nativeElement);t.find(".collapsible-header").addClass("active"),t.find(".collapsible").collapsible({accordion:!1}),this.openAbout()},t.prototype.onObstacleChange=function(t){this.worldRunner.setObstacles(t)},t.prototype.resetWorld=function(){this.worldRunner.reset(),this.worldRunner.setObstacles(this.obstacles)},t.prototype.insert=function(t){if(!t)return void n.i(a.toast)("Enter one or more instructions first.",2e3);var e="";this.allInstructions.forEach(function(t){e+=t.code});for(var i=0;i<t.length;i++)if(e.indexOf(t[i])==-1)return void n.i(a.toast)('"'+t[i]+'" is not a valid instruction.',2e3);this.worldRunner.insert(t)},t.prototype.openAbout=function(){this.modalActions.emit({action:"modal",params:["open"]})},t.prototype.closeAbout=function(){this.modalActions.emit({action:"modal",params:["close"]})},t=s([n.i(i.Component)({selector:"app-root",template:n(636),styles:[n(634)],providers:[r.a]}),l("design:paramtypes",["function"==typeof(e="undefined"!=typeof i.ElementRef&&i.ElementRef)&&e||Object,"function"==typeof(c="undefined"!=typeof r.a&&r.a)&&c||Object])],t);var e,c}()},468:function(t,e,n){"use strict";var i=n(194),a=n(0),r=n(437),o=n(443),s=n(306),l=(n.n(s),n(467)),c=n(471);n.d(e,"a",function(){return p});var u=this&&this.__decorate||function(t,e,n,i){var a,r=arguments.length,o=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,n,o):a(e,n))||o);return r>3&&o&&Object.defineProperty(e,n,o),o},h=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},p=function(){function t(){}return t=u([n.i(a.NgModule)({declarations:[l.a,c.a],imports:[i.b,r.a,o.a,s.MaterializeModule],providers:[],bootstrap:[l.a]}),h("design:paramtypes",[])],t)}()},469:function(t,e,n){"use strict";var i=n(0),a=n(470);n.d(e,"a",function(){return l});var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=this&&this.__decorate||function(t,e,n,i){var a,r=arguments.length,o=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,n,o):a(e,n))||o);return r>3&&o&&Object.defineProperty(e,n,o),o},s=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},l=function(t){function e(){t.apply(this,arguments)}return r(e,t),e=o([n.i(i.Injectable)(),s("design:paramtypes",[])],e)}(a.a)},470:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(){function t(){this.workerFunctionToUrlMap=new WeakMap,this.promiseToWorkerMap=new WeakMap}return t.prototype.run=function(t,e){var n=this.getOrCreateWorkerUrl(t);return this.runUrl(n,e)},t.prototype.runUrl=function(t,e){var n=new Worker(t),i=this.createPromiseForWorker(n,e);this.createPromiseCleaner(i);return this.promiseToWorkerMap.set(i,n),i},t.prototype.getWorker=function(t){return this.promiseToWorkerMap.get(t)},t.prototype.terminate=function(t){return this.removePromise(t)},t.prototype.createPromiseForWorker=function(t,e){return new Promise(function(n,i){t.addEventListener("message",function(t){return n(t.data)}),t.addEventListener("error",i),t.postMessage(e)})},t.prototype.getOrCreateWorkerUrl=function(t){if(!this.workerFunctionToUrlMap.has(t)){var e=this.createWorkerUrl(t);return this.workerFunctionToUrlMap.set(t,e),e}return this.workerFunctionToUrlMap.get(t)},t.prototype.createWorkerUrl=function(t){var e=t.toString(),n="("+e+")();",i=new Blob([n],{type:"text/javascript"});return URL.createObjectURL(i)},t.prototype.createPromiseCleaner=function(t){var e=this;return function(n){return e.removePromise(t),n}},t.prototype.removePromise=function(t){var e=this.promiseToWorkerMap.get(t);return e&&e.terminate(),this.promiseToWorkerMap.delete(t),t},t}()},471:function(t,e,n){"use strict";var i=n(0);n.d(e,"a",function(){return o});var a=this&&this.__decorate||function(t,e,n,i){var a,r=arguments.length,o=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,n,o):a(e,n))||o);return r>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},o=function(){function t(t){this.elementRef=t,this.lastWidth=0,this.lastHeight=0,this.magnification=5,this.magnificationSize=20,this.magnificationX=128,this.magnificationY=128,this.mouseDown=!1}return t.prototype.ngOnInit=function(){this.canvasOffScreen=$(this.elementRef.nativeElement).find(".off-screen-canvas")[0],this.canvasOnScreen=$(this.elementRef.nativeElement).find(".on-screen-canvas")[0]},t.prototype.clicked=function(t){var e=$(this.canvasOnScreen).width();this.magnificationX=256*t.clientX/e,this.magnificationY=256*t.clientY/e,t.preventDefault()},t.prototype.mousedown=function(t){this.mouseDown=!0,this.clicked(t)},t.prototype.mousemove=function(t){this.mouseDown&&this.clicked(t)},t.prototype.mouseup=function(t){this.mouseDown=!1},t.prototype.ngOnChanges=function(t){this.elementRef&&this.updatePixels()},t.prototype.ngDoCheck=function(){!this.canvasOffScreen,!this.canvasOnScreen;var t=$(this.elementRef.nativeElement).parent(),e=t.width()-20,n=t.height()-20;e==this.lastWidth&&n==this.lastHeight||(this.lastWidth=e,this.lastHeight=n);var i=Math.min(e,n);$(this.canvasOnScreen).css({width:i+"px",height:i+"px"}),$(this.canvasOffScreen).css({width:i+"px",height:i+"px"})},t.prototype.updatePixels=function(){if(this.pixels&&this.pixels.length){var t=this.pixels[0],e=this.canvasOffScreen;if(e){var n=e.getContext("2d"),i=this.worldSize,a=n.createImageData(i,i),r=!0;if(r){var o=new Uint8ClampedArray(t);a.data.set(o)}else for(var s=0,l=0;l<t.byteLength;l++)a.data[s++]=t[l];if(n.putImageData(a,0,0),n.webkitImageSmoothingEnabled=!1,n.mozImageSmoothingEnabled=n.msImageSmoothingEnabled=n.webkitImageSmoothingEnabled=n.imageSmoothingEnabled=!1,this.magnification>1){var c=this.magnificationX-this.magnificationSize/2,u=this.magnificationY-this.magnificationSize/2,h=this.magnificationX-this.magnificationSize/2*this.magnification,p=this.magnificationY-this.magnificationSize/2*this.magnification,d=this.magnification*this.magnificationSize;n.drawImage(e,c,u,this.magnificationSize,this.magnificationSize,h,p,d,d),n.strokeStyle="#ffffff",n.lineWidth=2,n.strokeRect(h,p,d,d)}}this.canvasOnScreen.getContext("2d").drawImage(e,0,0,256,256,0,0,256,256)}},t=a([n.i(i.Component)({selector:"app-world-view",template:n(637),styles:[n(635)],inputs:["pixels","worldSize"]}),r("design:paramtypes",["function"==typeof(e="undefined"!=typeof i.ElementRef&&i.ElementRef)&&e||Object])],t);var e}()},472:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i={production:!0}},473:function(t,e,n){"use strict";var i=n(493),a=(n.n(i),n(486)),r=(n.n(a),n(482)),o=(n.n(r),n(488)),s=(n.n(o),n(487)),l=(n.n(s),n(485)),c=(n.n(l),n(484)),u=(n.n(c),n(492)),h=(n.n(u),n(481)),p=(n.n(h),n(480)),d=(n.n(p),n(490)),f=(n.n(d),n(483)),m=(n.n(f),n(491)),v=(n.n(m),n(489)),g=(n.n(v),n(494)),y=(n.n(g),n(664));n.n(y)},474:function(t,e,n){"use strict";var i=n(302);n.d(e,"a",function(){return a});var a=function(){function t(){}return t.getColorForGenome=function(e){var n=t._genomeColorMap[e];return n||(n=t.colors[t.colorIndex],t._genomeColorMap[e]=n,t.colorIndex=(t.colorIndex+1)%t.colors.length),n},t.colorIndex=0,t.colors=[new i.a(255,0,0),new i.a(0,0,255),new i.a(128,128,255),new i.a(255,0,255),new i.a(128,0,0),new i.a(110,50,20),new i.a(128,128,0),new i.a(0,0,128),new i.a(128,0,128),new i.a(0,128,128),new i.a(128,128,128),new i.a(255,128,0),new i.a(93,186,202),new i.a(153,204,204),new i.a(255,175,24),new i.a(187,86,195),new i.a(89,24,187)],t._genomeColorMap={"*":new i.a(0,255,0)},t}()},475:function(t,e,n){"use strict";var i=n(0),a=n(97),r=n(203),o=n(305),s=n(202);n(96);n.d(e,"a",function(){return a.a}),n.d(e,"b",function(){return o.a}),n.d(e,"c",function(){return s.a});var l=this&&this.__decorate||function(t,e,n,i){var a,r=arguments.length,o=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,n,o):a(e,n))||o);return r>3&&o&&Object.defineProperty(e,n,o),o},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};(function(){function t(){}return t=l([n.i(i.NgModule)({declarations:[],imports:[],exports:[a.a,r.a,o.a,s.a]}),c("design:paramtypes",[])],t)})()},476:function(t,e,n){"use strict";var i=n(70),a=n(303),r=n(474),o=n(96),s=n(304);n.d(e,"a",function(){return l});var l=function(){function t(t,e,n){this.numExposedPhotosynthesizeCells=0,this.sleepCount=0,this.instructionsPerTurn=1,this.next=this.prev=null,this.headSegment=this.tailSegment=this.activeSegment=null,this.initialize(t,e,n)}return t.prototype.reset=function(){for(var e=this.headSegment;e;){var n=e.next;e.next=t.headElementInactive,t.headElementInactive=e,e=n,t.headElementInactive.reset()}this.headSegment=this.tailSegment=this.activeSegment=null,this.next=this.prev=null,this.numExposedPhotosynthesizeCells=0,this.sleepCount=0,this.instructionsPerTurn=0},t.prototype.initialize=function(t,e,n){this.genome=t;for(var i=0;i<t.length;i++){this.addSegment(t[i],e,n,i>0)}"*"===t[0]&&(this.numExposedPhotosynthesizeCells=1),this.energy=100*t.length,this.lifespan=n.parameters.lifespanPerSegment*t.length;var a=1+s.a.randRangeInt(-n.parameters.lifespanRandomizationPercent,n.parameters.lifespanRandomizationPercent)/100;this.lifespan*=a,this.randomizeOrientation(),this.colorRGBA=r.a.getColorForGenome(t).rgba},t.prototype.addSegment=function(e,n,a,r){var s=o.a.instructionFromCode(e);if(!s)throw"Unknown instruction: "+e;var l,c="*"==e?i.a.FOOD:i.a.ORGANISM;return t.headElementInactive?(l=t.headElementInactive,t.headElementInactive=t.headElementInactive.next,l.initialize(c,this)):l=new i.b(c,this),l.isOccluded=r,l.instruction=s,this.headSegment||(this.headSegment=l),this.tailSegment&&(this.tailSegment.next=l),this.tailSegment=l,r?(l.locationX=n.x,l.locationY=n.y):a.put(n.x,n.y,l),l},t.prototype.turnCrank=function(t){var e=this.instructionsPerTurn;for(--this.lifespan,this.numExposedPhotosynthesizeCells&&(this.energy+=t.parameters.energyGainedFromPhotosythesizing+(this.numExposedPhotosynthesizeCells-1)*(t.parameters.energyGainedFromPhotosythesizing-t.parameters.energyTurnCost));e--;)if(this.sleepCount)--this.sleepCount,++this.lifespan;else{this.activeSegment||(this.activeSegment=this.headSegment,this.instructionsPerTurn=1),this.energy-=t.parameters.energyTurnCost;var n=this.activeSegment.instruction.do(this,t,this.activeSegment);n!==o.b.DONT_ADVANCE&&this.activeSegment&&(this.activeSegment=this.activeSegment.next),n==o.b.EXECUTE_AGAIN&&this.activeSegment&&++e}},t.prototype.randomizeOrientation=function(){this.setOrientation(s.a.randRangeInt(0,4)%3)},t.prototype.setOrientation=function(t){switch(this.headOrientation=t,t){default:this.headDirectionX=0,this.headDirectionY=-1;break;case 1:this.headDirectionX=1,this.headDirectionY=0;break;case 2:this.headDirectionX=0,this.headDirectionY=1;break;case 3:this.headDirectionX=-1,this.headDirectionY=0}},t.prototype.move=function(t,e){this.wasBlocked=!1,this.energy-=e?t.parameters.energyMoveAndEatCost:t.parameters.energyMoveCost;var n=this.headSegment.locationX+this.headDirectionX&255,a=this.headSegment.locationY+this.headDirectionY&255,r=t.get(n,a);if(null==r)for(var o=this.headSegment;o;){var s=o.locationX,l=o.locationY;if(t.put(n,a,o),o.isOccluded){"*"===o.instruction.code&&++this.numExposedPhotosynthesizeCells,o.isOccluded=!1;break}n=s,a=l,o=o.next,o||t.put(n,a,null)}else if(this.wasBlocked=!0,e&&r.organism!=this)switch(r.type){case i.a.FOOD:if(this.wasBlocked=!1,r.organism){var c=Math.max(0,Math.min(r.organism.energy,t.parameters.biteStrength));this.energy+=c*t.parameters.digestionEfficiency/100,r.organism.energy-=t.parameters.biteStrength,r.organism.energy<0&&t.killOrganism(r.organism,!0)}else this.energy+=t.parameters.biteStrength,t.put(n,a,null);break;case i.a.ORGANISM:}var u=!1,h=!1,p={};if(u)for(var o=this.headSegment;o;){var d=o.locationX+","+o.locationY;p[d]=!0,o.isOccluded||t.get(o.locationX,o.locationY).organism!=this,!o.next&&o!=this.tailSegment,o=o.next}if(h)for(var f=0;f<256;f++)for(var m=0;m<256;m++)if(o=t.get(f,m),o&&o.organism==this){var d=f+","+m;!p[d]}},t.prototype.testIfFacing=function(t,e,n){void 0===n&&(n=10);var i=this.headSegment.locationX,a=this.headSegment.locationY;for(o.a.instructionFromCode("*");n--;){i=i+this.headDirectionX&255,a=a+this.headDirectionY&255;var r=e.get(i,a);if(r){if(r.organism==this)return!1;if(r.type==t)return!0}}return!1},t.prototype.doNotIf=function(){if(this.activeSegment){for(var t=this.activeSegment.next,e=this.activeSegment.next;e;){if("e"==e.instruction.code){t=e;break}e=e.next}this.activeSegment=t,this.activeSegment&&(this.activeSegment=this.activeSegment.next)}},t.prototype.getSpawnEnergy=function(t){return t.parameters.spawnEnergyPerSegment*this.genome.length},t.prototype.spawnIfAble=function(e){if(!(this.energy<this.getSpawnEnergy(e))){var n=this.genome,i=s.a.randRangeInt(0,100);i<e.parameters.mutationRate&&(n=this.mutateGenome(n));var r=this.tailSegment.locationX-this.headDirectionX&255,o=this.tailSegment.locationY-this.headDirectionY&255;if(null!=e.get(r,o))for(var l=-1;l<=1;l++)for(var c=-1;c<=1;c++){var u=this.tailSegment.locationX+l&255,h=this.tailSegment.locationY+c&255;if(l&&c&&null==e.get(u,h)){r=u,o=h,l=10;break}}if(null==e.get(r,o)){var p=new t(n,new a.a(r,o),e);this.energy=p.energy=this.energy/2,e.addOrganism(p)}}},t.prototype.mutateGenome=function(t){var e=s.a.randRangeInt(0,3),n=o.a.allCodes,i="";switch(e){case 0:for(var a=s.a.randRangeInt(0,t.length),r=0;r<=t.length;r++)r==a&&(i+=n[s.a.randRangeInt(0,n.length-1)]),r<t.length&&(i+=t[r]);break;case 1:if(1==t.length)i=t;else for(var a=s.a.randRangeInt(0,t.length-1),r=0;r<t.length;r++)r!=a&&(i+=t[r]);break;case 2:for(var a=s.a.randRangeInt(0,t.length-1),r=0;r<t.length;r++)i+=r==a?n[s.a.randRangeInt(0,n.length-1)]:t[r];break;case 3:if(1==t.length)i=t;else if(2==t.length)i=t[1]+t[0];else for(var a=s.a.randRangeInt(0,t.length-2),r=0;r<t.length;r++)r==a?(i+=t[r+1]+t[r],++r):i+=t[r]}return i},t.headElementInactive=null,t}()},477:function(t,e,n){"use strict";var i=n(97),a=n(70),r=n(202),o=n(476),s=n(303),l=n(304);n.d(e,"a",function(){return c});var c=function(){function t(t){this.MAX_WORLD_SIZE=256,this.numOrganisms=0,this.turn=1,this.foodElement=new a.b(a.a.FOOD),this.barrierElement=new a.b(a.a.BARRIER),this.newObstacles=void 0,new r.a,this.parameters=t,this.elements=[];for(var e=0;e<this.MAX_WORLD_SIZE;e++){this.elements.push([]);for(var n=0;n<this.MAX_WORLD_SIZE;n++)this.elements[e].push(null)}this.reset()}return t.prototype.reset=function(){for(var t=0;t<this.MAX_WORLD_SIZE;t++)for(var e=0;e<this.MAX_WORLD_SIZE;e++)this.elements[t][e]=null;this.headOrganism=null,this.headOrganismInactive=null,this.numOrganisms=0;for(var t=0;t<this.parameters.initialFoodCount;t++){var n=this.getEmptyLocation(),i=this.createOrganism("*",n);i.energy=l.a.randRangeInt(-1e3,i.getSpawnEnergy(this))}},t.prototype.validate=function(){for(var t=this.headOrganism;t;){for(var e=t.headSegment,n=e.locationX,i=e.locationY;e;){if(e.organism!=t)throw"segment organism bad";var a=this.elements[e.locationX][e.locationY];if(!a)throw"`xxx`";if(a.organism!=t)throw"board is bad";if(a.isOccluded)throw"element is occluded";if(e=e.next){if(e.locationX==n&&e.locationY==i){if(!e.isOccluded)throw"should be occluded"}else if(e.isOccluded)throw"incorrectly occluded";n=e.locationX,i=e.locationY}}t=t.next}},t.prototype.getEmptyLocation=function(){for(var t=new s.a;;)if(t.randomize(i.a.WORLDSIZE),null==this.elements[t.x][t.y])return t},t.prototype.put=function(t,e,n){t&=255,e&=255,this.elements[t][e]=n,n&&(n.locationX=t,n.locationY=e)},t.prototype.get=function(t,e){return this.elements[255&t][255&e]},t.prototype.turnCrank=function(){this.prepareObstacles();var t=this.headOrganism;++this.turn;for(var e=0;t;){var n;n=void 0,t.energy<0&&"*"!=t.genome||t.lifespan<0?(n=t.next,this.killOrganism(t)):(t.turnCrank(this),this.numOrganisms<this.parameters.maximumOrganisms&&t.spawnIfAble(this)),t=void 0!==n?n:t.next,++e}if(this.turn%100==0,this.parameters.foodDropSpeed&&(this.parameters.foodDropSpeed>=99||this.turn%(100-this.parameters.foodDropSpeed)==0))for(var e=0;e<5;e++){var i=this.getEmptyLocation();this.put(i.x,i.y,this.foodElement)}},t.prototype.insert=function(t){var e=this.getEmptyLocation();this.createOrganism(t,e)},t.prototype.createOrganism=function(t,e){if(this.elements[e.x][e.y])return null;var n,i=!0;return i&&this.headOrganismInactive?(n=this.headOrganismInactive,this.headOrganismInactive=this.headOrganismInactive.next,n.next=n.prev=null,n.initialize(t,e,this)):n=new o.a(t,e,this),this.addOrganism(n),n},t.prototype.addOrganism=function(t){++this.numOrganisms;var e=this.headOrganism;this.headOrganism=t,e&&(e.prev=t,t.next=e)},t.prototype.killOrganism=function(t,e){void 0===e&&(e=!1),--this.numOrganisms,t==this.headOrganism?(this.headOrganism=t.next,this.headOrganism&&(this.headOrganism.prev=null)):(t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next));var n=t.headSegment;if("*"==t.genome)return void this.put(n.locationX,n.locationY,null);for(;n;)this.put(n.locationX,n.locationY,null),n=n.next;for(n=t.headSegment;n&&!n.isOccluded;)e||this.put(n.locationX,n.locationY,this.foodElement),n=n.next;t.reset(),t.next=this.headOrganismInactive,this.headOrganismInactive=t},t.prototype.setObstacles=function(t){this.newObstacles=t},t.prototype.prepareObstacles=function(){if(void 0!==this.newObstacles){var t=this.newObstacles;this.newObstacles=void 0;for(var e=0;e<this.MAX_WORLD_SIZE;e++)for(var n=0;n<this.MAX_WORLD_SIZE;n++)this.elements[e][n]&&this.elements[e][n].type==a.a.BARRIER&&this.put(e,n,null);var i=[];switch(t){case 1:for(var r=0;r<124;r++)i.push(new s.a(r,r)),i.push(new s.a(255-r,r)),i.push(new s.a(r,255-r)),i.push(new s.a(255-r,255-r));break;case 2:for(var r=2;r<254;r++)i.push(new s.a(r,2)),i.push(new s.a(r,253)),i.push(new s.a(2,r)),i.push(new s.a(253,r))}var o=this;i.forEach(function(t){o.elements[t.x][t.y]&&o.elements[t.x][t.y].organism&&o.killOrganism(o.elements[t.x][t.y].organism,!0),o.put(t.x,t.y,o.barrierElement)})}},t}()},634:function(t,e){t.exports=".top-ten-list{\n    padding:10px;\n}\n\n.top-ten-list .header-row{\n    background:#eeeeee;\n    font-size:80%;\n}\n\n.top-ten-list .entry-row{\n    background:#ffffff;\n    background:-webkit-linear-gradient(top,  #ffffff 0%,#f0f0f0 97%,#fafafa 100%);\n    background:linear-gradient(to bottom,  #ffffff 0%,#f0f0f0 97%,#fafafa 100%);\n    filter:progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#fafafa',GradientType=0 );\n}\n\n.top-ten-list td, .top-ten-list th{\n    padding:4px;\n}\n\n.top-ten-list td:nth-child(1), .top-ten-list th:nth-child(1){\n    width:20px;\n}\n\n.top-ten-list td:nth-child(2), .top-ten-list th:nth-child(2){\n    width:50px;\n}\n\n.top-ten-list .genomeColor{\n    position:relative;\n    width:16px;\n    height:16px;\n}\n\n.param-label{\n    width:140px;\n    padding-top:5px;\n    text-align:right;\n    font-size:80%;\n}\n\n.param-row{\n    margin-bottom:0!important;\n}\n\n.param-label{\n    max-width:150px;\n}\n\n.user-genome{\n    width:150px;\n}"},635:function(t,e){t.exports=".off-screen-canvas{\n    display:none;\n}\n"},636:function(t,e){t.exports='<div class="fluid-container">\n  <div class="row">\n\n    <div class="col s6">\n      <app-world-view [pixels]="renderPixels" worldSize="256"></app-world-view>\n\n      <!-- GENERAL PARAMETERS -->\n      <!--   SPEED: -->\n      <div class="row param-row">\n        <div class="col param-label">Speed:</div>\n        <div class="col s6"><input [(ngModel)]="params.speed" type="range" name="points" min="0" max="10"></div>\n        <div class="col s2">{{params.speed}}</div>\n      </div>\n\n      <!--   MUTATION RATE: -->\n      <div class="row param-row">\n        <div class="col param-label">Mutation rate:</div>\n        <div class="col s6"><input [(ngModel)]="params.mutationRate" type="range" name="points" min="0" max="50"></div>\n        <div class="col s2 param-label">{{params.mutationRate}}%</div>\n      </div>\n\n      <!--   FOOD DROP RATE: -->\n      <div class="row param-row">\n        <div class="col param-label">Food drop rate:</div>\n        <div class="col s6"><input [(ngModel)]="params.foodDropSpeed" type="range" name="points" min="0" max="100"></div>\n        <div class="col s2 param-label">{{params.foodDropSpeed}}%</div>\n      </div>\n\n      <div class="row param-row">\n        <div class="col param-label">Obstacles:</div>\n        <div class="col s6"><input [(ngModel)]="obstacles" (ngModelChange)="onObstacleChange($event)"\n           type="range" name="points" min="0" max="2"></div>\n        <div class="col s2 param-label">{{(obstacles==0) ? \'None\' : ("#" + obstacles)}}</div>\n      </div>\n\n\n      <!-- ADVANCED SETTINGS -->\n      <ul materialize="collapsible" class="collapsible" data-collapsible="accordion">\n        <li>\n          <div class="collapsible-header"><i class="material-icons">settings</i>Advanced Settings</div>\n          <div class="collapsible-body">\n    \n            <div class="row param-row">\n              <div class="col param-label">Spawn energy:</div>\n              <div class="col s6"><input [(ngModel)]="params.spawnEnergyPerSegment" type="range" name="points" min="50" max="500"></div>\n              <div class="col s2  param-label">{{params.spawnEnergyPerSegment}} per segment</div>\n            </div>\n    \n            <div class="row param-row">\n              <div class="col param-label">Lifespan:</div>\n              <div class="col s6"><input [(ngModel)]="params.lifespanPerSegment" type="range" name="points" min="5000" max="50000"></div>\n              <div class="col s2 param-label">{{params.lifespanPerSegment}} per segment</div>\n            </div>\n    \n            <div class="row param-row">\n              <div class="col param-label">Photosynthesis gain:</div>\n              <div class="col s6"><input [(ngModel)]="params.energyGainedFromPhotosythesizing"\n                type="range" name="points" min="1" max="3" step=".05"></div>\n              <div class="col s2 param-label">{{(params.energyGainedFromPhotosythesizing - 1) | number:\'1.2-2\'}}</div>\n            </div>\n    \n            <div class="row param-row">\n              <div class="col param-label">Move cost:</div>\n              <div class="col s6"><input [(ngModel)]="params.energyMoveCost" type="range" name="points" min="0" max="20" step=".05"></div>\n              <div class="col s2 param-label">{{params.energyMoveCost | number:\'1.2-2\'}}</div>\n            </div>\n    \n            <div class="row param-row">\n              <div class="col param-label">Move and eat cost:</div>\n              <div class="col s6"><input [(ngModel)]="params.energyMoveAndEatCost" type="range" name="points" min="0" max="20" step=".05"></div>\n              <div class="col s2 param-label">{{params.energyMoveAndEatCost | number:\'1.2-2\'}}</div>\n            </div>\n\n            <div class="row param-row">\n              <div class="col param-label">Bite strength:</div>\n              <div class="col s6"><input [(ngModel)]="params.biteStrength" type="range" name="points" min="0" max="1000"></div>\n              <div class="col s2 param-label">{{params.biteStrength}}</div>\n            </div>\n\n            <div class="row param-row">\n              <div class="col param-label">Digestion efficiency:</div>\n              <div class="col s6"><input [(ngModel)]="params.digestionEfficiency" type="range" name="points" min="0" max="100"></div>\n              <div class="col s2 param-label">{{params.digestionEfficiency}}%</div>\n            </div>\n          </div>\n        </li>\n      </ul>\n\n    </div>\n\n    <div class="col s6">\n\n      <button (click)="resetWorld()" class="waves-effect waves-light btn">Reset</button>\n      <button (click)="insert(\'*\')" class="waves-effect waves-light btn">Insert "*"</button>\n      <button (click)="insert(\'M\')" class="waves-effect waves-light btn">Insert "M"</button>\n      <button (click)="insert(userGenome)" class="waves-effect waves-light btn">Insert: </button>\n      <input class="user-genome" type="text" [(ngModel)]="userGenome" placeholder="Genome">\n\n      <!-- TOP TEN SPECIES -->\n      <ul materialize="collapsible" class="collapsible"> <!-- data-collapsible="accordion"> -->\n        <li>\n          <div class="collapsible-header"><i class="material-icons">whatshot</i>Top 10 Species</div>\n          <div class="collapsible-body">\n\n            <table class="top-ten-list">\n\n              <tr class="header-row">\n                <th></th>\n                <th>#</th>\n                <th>Genome</th>\n              </tr>\n\n              <tr class="entry-row" *ngFor=\'let critterStats of topTen\'>\n                <td>\n                  <div class="genomeColor" [style.backgroundColor]="critterStats.color"></div>\n                </td>\n\n                <td>\n                  {{critterStats.count}}\n                </td>\n\n                <td>\n                  {{critterStats.genome}}\n                </td>\n              </tr>\n            </table>\n          </div>\n        </li>\n      </ul>\n\n\n      <!-- INSTRUCTION SET -->\n      <ul materialize="collapsible" class="collapsible" data-collapsible="accordion">\n        <li>\n          <div class="collapsible-header"><i class="material-icons">shuffle</i>Instruction Set</div>\n          <div class="collapsible-body">\n\n            <table class="top-ten-list">\n            \n              <tr class="entry-row" *ngFor=\'let instruction of allInstructions\'>\n                <td>\n                  {{instruction.code}}\n                </td>\n\n                <td>\n                  {{instruction.description}}\n                </td>\n              </tr>\n            </table>\n          </div>\n        </li>\n      </ul>\n\n\n\n    </div>\n\n  </div>\n</div>\n\n<!--\n<h1>\n  {{title}}\n</h1>\n\n<button class="waves-effect waves-light btn">Test Button</button>\n\n\n<div flex layout="column" class="full-screen">\n  <div flex>Title bar</div>\n\n  <div flex="50" layout="row"> \n    <div flex class="column-simulation">\n      First column\n\n\n      <app-world-view [pixels]="renderPixels" style="width:512px;height:512px"></app-world-view>\n    </div>\n    \n    <div flex="50" class="column-controls">\n      column controls\n    <ul materialize="collapsible" class="collapsible" data-collapsible="accordion">\n          <li>\n            <div class="collapsible-header"><i class="material-icons">filter_drama</i>First</div>\n            <div class="collapsible-body"><p>Lorem ipsum dolor sit amet.</p></div>\n          </li>\n          <li>\n            <div class="collapsible-header"><i class="material-icons">place</i>Second</div>\n            <div class="collapsible-body"><p>Lorem ipsum dolor sit amet.</p></div>\n          </li>\n          <li>\n            <div class="collapsible-header"><i class="material-icons">whatshot</i>Third</div>\n            <div class="collapsible-body"><p>Lorem ipsum dolor sit amet.</p></div>\n          </li>\n        </ul>\n              \n      Second column\n      <input [(ngModel)]="params.speed" type="range" name="points" min="0" max="10">\n      params = {{params | json}}<br>\n        Speed = {{speed}}\n\n    </div>\n  </div>\n\n  <div flex>bottom bar</div>\n</div>\n-->\n\n<!-- Modal Trigger -->\n<a class="waves-effect waves-light btn modal-trigger" (click)="openAbout()">Modal</a>\n \n<!-- Modal Structure -->\n<div id="modal1" class="modal bottom-sheet" materialize="modal" [materializeParams]="[{dismissible: false}]" [materializeActions]="modalActions">\n  <div class="modal-content">\n    <h4>Yet another evolutionary simulation</h4>\n    <p>A bunch of text</p>\n  </div>\n  <div class="modal-footer">\n    <a class="waves-effect waves-green btn-flat" (click)="closeAbout()">Close</a>\n  </div>\n</div>';
},637:function(t,e){t.exports='<canvas class="world-view off-screen-canvas" width="256" height="256"></canvas>\n<canvas class="world-view on-screen-canvas" width="256" height="256"\n    on-mousedown="mousedown($event)"\n    on-mousemove="mousemove($event)"\n    on-mouseup="mouseup($event)"></canvas>'},665:function(t,e,n){t.exports=n(357)},70:function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return a});var i;!function(t){t[t.BARRIER=0]="BARRIER",t[t.FOOD=1]="FOOD",t[t.POISON=2]="POISON",t[t.ORGANISM=3]="ORGANISM"}(i||(i={}));var a=function(){function t(t,e){void 0===e&&(e=null),this.initialize(t,e)}return t.prototype.reset=function(){this.organism=null,this.next=null,this.instruction=null},t.prototype.initialize=function(t,e){if(void 0===e&&(e=null),this.type=t,this.organism=e,t==i.ORGANISM&&!e)throw"Element must have an organism object if of ORGANISM type!";t!=i.ORGANISM&&e},t}()},96:function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return r});var i;!function(t){t[t.DONT_ADVANCE=0]="DONT_ADVANCE",t[t.EXECUTE_AGAIN=1]="EXECUTE_AGAIN"}(i||(i={}));var a=function(){function t(t,e,n){this._name=t,this._key=e,this._defaultValue=n}return Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultValue",{get:function(){return this._defaultValue},enumerable:!0,configurable:!0}),t}(),r=function(){function t(e,n,i,r){void 0===i&&(i=t.DEFAULT_ENERGY_IMPACT),void 0===r&&(r=null),this._code=e,this._description=n,this._parameterDefinitions=r,this._parameters={},t.allCodes+=e,t._instructionMap[e]=this;var o=new a("Energy impact","energyImpact",t.DEFAULT_ENERGY_IMPACT);null==this._parameterDefinitions?this._parameterDefinitions=[o]:this._parameterDefinitions.push(o);for(var s in this._parameterDefinitions){var l=this._parameterDefinitions[s];this._parameters[l.key]=l.defaultValue}t._allInstructions?t._allInstructions.push(this):t._allInstructions=[this]}return Object.defineProperty(t,"allInstructions",{get:function(){return t._allInstructions},enumerable:!0,configurable:!0}),t.instructionFromCode=function(e){return t._instructionMap[e]},Object.defineProperty(t.prototype,"description",{get:function(){return this._description},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this._code},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"energyImpact",{get:function(){return this._parameters.energyImpact},enumerable:!0,configurable:!0}),t.DEFAULT_ENERGY_IMPACT=-.5,t._instructionMap={},t.allCodes="",t}()},97:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(){function t(){this.speed=5,this.maximumOrganisms=3e4,this.initialFoodCount=1e3,this.foodDropSpeed=50,this.mutationRate=10,this.spawnEnergyPerSegment=200,this.lifespanPerSegment=5e4,this.lifespanRandomizationPercent=10,this.energyTurnCost=1,this.energyMoveCost=2,this.energyMoveAndEatCost=15,this.energyGainedFromPhotosythesizing=1.25,this.biteStrength=200,this.digestionEfficiency=50}return t.WORLDSIZE=256,t}()}},[665]);
//# sourceMappingURL=main.88103a8f7d889a7b030d.bundle.map